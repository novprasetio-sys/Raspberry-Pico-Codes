import network
import urequests
import machine
import time

# Inisialisasi pin
mq2_pin = 2
mq2_adc = machine.ADC(machine.Pin(mq2_pin))

# Inisialisasi WiFi
wifi = network.WLAN(network.STA_IF)
wifi.active(True)
wifi.connect('SSID', 'PASSWORD')

# Inisialisasi Thingspeak
thingspeak_api_key = 'YOUR_API_KEY'
thingspeak_url = 'https://api.thingspeak.com/update?api_key=' + thingspeak_api_key

while True:
    try:
        # Baca data MQ2
        mq2_value = mq2_adc.read_u16()
        
        # Kirim data ke Thingspeak
        url = thingspeak_url + '&field1=' + str(mq2_value)
        urequests.get(url)
        
        print('MQ2 Value:', mq2_value)
    except Exception as e:
        print('Error:', e)
    time.sleep(15)